<h2><span>Help &raquo; Tutorial</span></h2>

<p>(If you already have a bit of experience with nanoc, you may find the <a href="/help/manual/">Manual</a> a very useful resource in addition to this tutorial.)</p>

<div class="section" id="installing-nanoc">
	<h3><span>Installing nanoc</span></h3>

	<p>nanoc requires <a href="http://www.ruby-lang.org/">Ruby</a> (1.8.5 or higher required). nanoc also requires <a href="http://rubyforge.org/projects/rubygems/">RubyGems</a>. You may already have RubyGems installed, but if you don't, <a href="http://rubyforge.org/frs/?group_id=126&amp;release_id=16500">get it here</a>.</p>

	<p>Once you have RubyGems, installing nanoc is easy. Simply write this in your terminal:</p>

	<pre><kbd>sudo gem install nanoc</kbd></pre>
</div>

<div class="section" id="requirements-for-this-tutorial">
	<h3><span>Requirements for this Tutorial</span></h3>

	<p>This tutorial requires <a href="http://whytheluckystiff.net/ruby/redcloth">RedCloth</a>. RedCloth is a Ruby implementation of both <a href="http://www.textism.com/tools/textile/">Textile</a> and <a href="http://daringfireball.net/projects/markdown/">Markdown</a>, which both allow you to write HTML in a easy-to-use plain text format. In this tutorial, we'll use Markdown. (If you haven't used Markdown before, don't fear&mdash;it's easy.) To install RedCloth, jump to your terminal and type:</p>

	<pre><kbd>sudo gem install RedCloth</kbd></pre>

	<p>You can also use BlueCloth (which only handles Markdown) instead of RedCloth for this tutorial, but there unfortunately seems to be an incompatibility between BlueCloth and Ruby 1.9.</p>
</div>

<div class="section" id="creating-your-first-nanoc-powered-site">
	<h3><span>Creating your First nanoc-powered Site</span></h3>

	<p>nanoc is a command-line application. This means that in order to use nanoc, you have to type geeky commands into a terminal all day. Hey, that's the way all cool apps work (or maybe not).</p>

	<p>A nanoc-powered site is a directory with a specific structure. In this tutorial, we'll create a site named <span class="path">nanoc_test</span>. To create this site, type into the terminal:</p>

	<pre><kbd>nanoc create_site nanoc_test</kbd></pre>

	<p>If you did that right, you should have seen this appear on the screen:</p>

	<pre><samp><span class="log-create">create</span>  config.yaml
<span class="log-create">create</span>  Rakefile
<span class="log-create">create</span>  tasks/default.rake
<span class="log-create">create</span>  content/content.yaml
<span class="log-create">create</span>  content/content.html
<span class="log-create">create</span>  asset_defaults.yaml
<span class="log-create">create</span>  page_defaults.yaml
<span class="log-create">create</span>  layouts/default/default.yaml
<span class="log-create">create</span>  layouts/default/default.html
<span class="log-create">create</span>  templates/default/default.yaml
<span class="log-create">create</span>  templates/default/default.html
<span class="log-create">create</span>  lib/default.rb</samp></pre>

	<p>The nanoc-powered site named <span class="path">nanoc_test</span> has now been created. Go into the directory and list the files there. You should see something like this:</p>

	<pre><samp>-rw-r--r--  1 ddfreyne  ddfreyne  123 16 Jul 19:13 Rakefile
-rw-r--r--  1 ddfreyne  ddfreyne   63 16 Jul 19:13 asset_defaults.yaml
drwxr-xr-x  2 ddfreyne  ddfreyne   68 16 Jul 19:13 assets
-rw-r--r--  1 ddfreyne  ddfreyne   71 16 Jul 19:13 config.yaml
drwxr-xr-x  4 ddfreyne  ddfreyne  136 16 Jul 19:13 content
drwxr-xr-x  3 ddfreyne  ddfreyne  102 16 Jul 19:13 layouts
drwxr-xr-x  3 ddfreyne  ddfreyne  102 16 Jul 19:13 lib
drwxr-xr-x  2 ddfreyne  ddfreyne   68 16 Jul 19:13 output
-rw-r--r--  1 ddfreyne  ddfreyne  136 16 Jul 19:13 page_defaults.yaml
drwxr-xr-x  3 ddfreyne  ddfreyne  102 16 Jul 19:13 tasks
drwxr-xr-x  3 ddfreyne  ddfreyne  102 16 Jul 19:13 templates</samp></pre>

	<p>What all those directories are for, will be explained in just a minute, step by step.</p>
</div>

<div class="section" id="compiling-the-site">
	<h3><span>Compiling the Site</span></h3>

	<p>Before doing anything else, make sure the current working directory is the site you just created. All nanoc commands, except for <kbd>create_site</kbd>, require the current working directory to be a nanoc site. So, if you haven't done it before:</p>

	<pre><kbd>cd nanoc_test</kbd></pre>

	<p>Every new nanoc site already has a bit of content. It comes with one simple page with some simple "getting started" instructions. Before you can view the site, it needs to be compiled. To compile the site, do this:</p>

	<pre><kbd>nanoc compile</kbd></pre>

	<p>This is what'll appear in the terminal when nanoc is done compiling:</p>

	<pre><samp>Compiling site...
    <span class="log-create">create</span>  [0.00s] output/index.html

Site compiled in 0.00s.</samp></pre>

	<p>A file named <span class="path">index.html</span> has been created in the <span class="path">output</span> directory. Open it in your favourite web browser (mine is Safari); what you'll see is something like this:</p>

	<div class="figure">
		<img style="border: 6px solid #ccc" src="/assets/images/help/tutorial/default-site.png" alt="Screenshot of what a brand new nanoc site looks like">
	</div>

	<p>You can also open the <span class="path">output/index.html</span> file in your favourite text editor, where you'll find that the file is just a normal HTML page. No big surprise there.</p>
</div>

<div class="section" id="editing-the-home-page">
	<h3><span>Editing the Home Page</span></h3>

	<p>The first step in getting to know how nanoc really works will involve editing the content of the home page. First, though, a quick explanation of how uncompiled pages are stored.</p>

	<p>The pages in a nanoc site are stored in the <span class="path">content</span> directory. Currently, that directory has only two files: <span class="path">content.html</span> and <span class="path">content.yaml</span>. These two files together form the home page. The file ending with <span class="path">.yaml</span> contain the page's attributes (or metadata, or properties, or whatever you want to call it), while the other file contains the actual page content. This may sound confusing, but it'll make more sense once more pages are added to the site. Patience, young padawan.</p>

	<p>Let's change the content of the home page. Open <span class="path">content.txt</span> and add a paragraph somewhere in the file. I recommend something like this:</p>

	<pre><kbd>&lt;<span class="element">p</span>&gt;This is a brand new paragraph which I've just inserted into this file!
Gosh, I can barely control my excitement!&lt;/<span class="element">p</span>&gt;</kbd></pre>

	<p>To view the changes, the site must be recompiled first. So, do this:</p>

	<pre><kbd>nanoc compile</kbd></pre>

	<p>And this is what you'll see:</p>

	<pre><samp>Compiling site...
  <span class="log-update">update</span>  [0.00s] output/index.html

Site compiled in 0.00s.</samp></pre>

	<p>Note the numbers: the entire site was compiled in 0 seconds. No big surprise, considering there's barely any content. Also note how nanoc prints the time spent compiling for each individual page as well.</p>

	<p>Open <span class="path">index.html</span> in the <span class="path">output</span> directory in your web browser and your text editor again, and verify that the page has indeed been updated.</p>

	<p>One thing that hasn't changed is the page title&mdash;the title that appears in the browser's title bar. The page title is defined in the page's meta file. Such a meta file contains all metadata about the page, e.g. the layout that should be used for this page, the page title, the page's author, when this page was created, &hellip; The homepage meta file, <span class="path">content.yaml</span>, looks like this right now:</p>

	<pre><samp><span class="comment"># Built-in</span>

<span class="comment"># Custom</span>
<span class="attribute">title</span>: <span class="string">Home</span></samp></pre>

	<p>This file is split into two sections: <i>Built-in</i> and <i>Custom</i>. In the <i>Built-in</i> section, you can put metadata that is used by nanoc itself. For example, the <code>layout</code> attribute is used to determine which layout this page uses. (There's a full list of built-in attributes in <a href="/help/manual/chapter-2/">chapter 2 of the manual</a>, which you definitely should check out at some point.)</p>

	<p>The <i>Custom</i> section is for custom metadata that isn't used by the nanoc compiler. Any attributes that aren't built-in are custom. Custom metadata could include the page title, keywords relevant to this page, the name of the page's author, the language the page is written in, etc.</p>

	<p>The homepage's meta file currently has one attribute, <code>title</code>. Change this to something cooler, like this:</p>

	<pre><samp><span class="attribute">title</span>: <span class="string">"The Guild of nanoc: a fan website dedicated to nanoc"</span></samp></pre>

	<p>Recompile the site and open <span class="path">index.html</span> in your browser. You will see that the browser's title bar displays the page's title now. If you're wondering how exactly nanoc knew that it had to update the stuff between the <code>&lt;title&gt;</code> and <code>&lt;/title&gt;</code> tags: don't worry. There's no magic involved. It'll all become crystal clear in a minute. (If you want to be spoiled: take a peek at <span class="path">layouts/default/default.html</span>.)</p>
</div>

<div class="section" id="adding-a-page">
	<h3><span>Adding a Page</span></h3>

	<p>To create a new page in the site, use the <kbd>create_page</kbd> command. Let's create an "about" page like this:</p>

	<pre><samp>nanoc create_page about</samp></pre>

	<p>You should see this:</p>

	<pre><samp><span class="log-create">create</span>  content/about/about.yaml
<span class="log-create">create</span>  content/about/about.html</samp></pre>

	<p>There is now a <span class="path">content/about</span> directory, with two files in it: the content file and the meta file. Open the content file (<span class="path">content/about/about.html</span>) and put some text in it, like this:</p>

	<pre><samp>&lt;<span class="element">h1</span>&gt;My cute little "About" page&lt;/<span class="element">h1</span>&gt;

&lt;<span class="element">p</span>&gt;This is the about page for my new nanoc site.&lt;/<span class="element">p</span>&gt;</samp></pre>

	<p>Edit the meta file (the YAML one) so it looks like this:</p>

	<pre><samp><span class="comment"># Built-in</span>

<span class="comment"># Custom</span>
<span class="attribute">title</span>: <span class="string">"The Guild of nanoc -- About the Guild"</span></samp></pre>

	<p>Recompile the site, and notice that a file <span class="path">output/about/index.html</span> has been created. Open that file in your web browser, and admire your brand new about page. Shiny!</p>
</div>

<div class="section" id="customizing-the-layout">
	<h3><span>Customizing the Layout</span></h3>

	<p>The default home page recommended editing the default layout, so let's see what we can do there.</p>

	<p>As you probably have noticed already, the page's content files are not really HTML files&mdash;they are <em>partial</em> HTML files. A page needs <code>&lt;html&gt;</code>, <code>&lt;head&gt;</code>, <code>&lt;body&gt;</code>, &hellip; elements before it's valid HTML. This doesn't mean you've been writing invalid HTML all along, though, because nanoc <em>layouts</em> each page as a part of the compilation process.</p>

	<p>Take a look in the <span class="path">layouts</span> directory. It contains a directory <span class="path">default</span> with two files, one called <span class="path">default.html</span> and the other called <span class="path">default.yaml</span>. These two files form the default layout of the web site, and is also the layout used by the home page and the about page.</p>

	<p>Open <span class="path">default.html</span> in your favourite text editor. It <em>almost</em> looks like a HTML page, with the exception of this piece of code:</p>

	<pre><code>...
&lt;<span class="element">div</span> <span class="attribute">id</span>=<span class="string">&quot;main&quot;</span>&gt;
&lt;%= <span class="variable">@page</span>.<span class="function">content</span> %&gt;
&lt;/<span class="element">div</span>&gt;
...</code></pre>

	<p>The odd construct in the middle of that piece of code is an <em>embedded Ruby</em> instruction. The <code>&lt;%= <span class="variable">@page</span>.<span class="function">content</span> %&gt;</code> instruction will be replaced with the page's compiled content when compiling.</p>

	<p>If you are not familiar with embedded Ruby (also known as eRuby), take a look at the <a href="http://en.wikipedia.org/wiki/ERuby">eRuby article on Wikipedia</a>, or the <a href="http://ruby-doc.org/docs/ProgrammingRuby/html/web.html#S2"><i>Embedding Ruby in HTML</i> section</a> of the <i>Ruby and the Web</i> chapter of the online <i>Programming Ruby</i> book.</p>

	<p>In fact&mdash;maybe you've noticed it already&mdash;there's another important piece of embedded Ruby code near the top of the file:</p>

	<pre><code>&lt;<span class="element">title</span>&gt;A Brand New nanoc Site - &lt;%= <span class="variable">@page</span>.<span class="function">title</span> %&gt;&lt;/<span class="element">title</span>&gt;</code></pre>

	<p>This is where the page's title is put into the compiled document.</p>

	<p>Every page can have arbitrary metadata associated with it. For example, you can set the <code>author_name</code> attribute to your own name, quite similar to how the <code>title</code> attribute is set. Some attribute names are reserved though, such as the <code>content</code> one (mentioned above), the <code>path</code> (which contains the page's path), and a few others. <a href="/help/manual/chapter-2/">Chapter 2 of the manual</a> has a full list.</p>

	<p>To demonstrate this, add the following line to the <i>Custom</i> section of the meta file (you could also add it to the <i>Built-in</i> section, but really, why would you want to do that?):</p>

	<pre><samp><span class="attribute">author</span>: <span class="string">"John Doe"</span></samp></pre>

	<p>Now output the author name in the layout. Put this piece of code somewhere in your layout (somewhere between the <code>&lt;body&gt;</code> and <code>&lt;/body&gt;</code> tags, please, or you won't see a thing):</p>

	<pre><code>&lt;% <span class="keyword">unless</span> <span class="variable">@page</span>.<span class="function">author</span>.<span class="function">nil?</span> %&gt;
&lt;<span class="element">p</span>&gt;This page was written by &lt;%= <span class="variable">@page</span>.<span class="function">author</span> %&gt;.&lt;/<span class="element">p</span>&gt;
&lt;% <span class="keyword">end</span> %&gt;</code></pre>

	<p>Recompile the site, and open the <span class="path">output/index.html</span> and <span class="path">output/about/index.html</span> pages in your browser. You'll see that the about page has a line saying <q>This page was written by John Doe</q>, while the home page does not&mdash;as expected!</p>
</div>

<hr>

<div class="section" id="writing-pages-in-markdown">
	<h3><span>Writing Pages in Markdown</span></h3>

	<p>You don't have to write pages in HTML. Sometimes, it is easier to use another language which can be converted to HTML instead. In this example, we'll use <a href="http://daringfireball.net/projects/markdown">Markdown</a> to avoid having to write HTML. nanoc calls these text transformations <em>filters</em>.</p>

	<p>Let's get rid of the contents of the home page and replace it with some Markdown-formatted text. Open <span class="path">content/content.txt</span> and put this in instead:</p>

	<pre><code>A First Level Header
====================

A Second Level Header
---------------------

Now is the time for all good men to come to
the aid of their country. This is just a
regular paragraph.

The quick brown fox jumped over the lazy
dog's back.

### Header 3

> This is a blockquote.
> 
> This is the second paragraph in the blockquote.
>
> ## This is an H2 in a blockquote</code></pre>

	<p>If you would compile the site now, the compiled HTML page won't display the converted HTML just yet, because we haven't told nanoc to filter this page as Markdown yet. Open the homepage's meta file and add this line to the "built-in" section:</p>

	<pre><samp><span class="attribute">filters_pre</span>:
- <span class="string">"redcloth"</span></samp></pre>

	<p><code>filters_pre</code> is an attribute with a list of filters to run before laying out the page. You can also run filters <em>after</em> laying out the page, in which case you'd use <code>filters_post</code>. <a href="/help/manual/chapter-2/">Chapter 2 of the manual</a> has a list of built-in filters you can use.</p>

	<p>Now that we've told nanoc to filters this page using RedCloth, let's recompile the site. (If you are getting errors at this point, make sure you have RedCloth installed, as described at the beginning of this tutorial). The <span class="path">output/index.html</span> page source should now look like this:</p>

	<pre><code>&lt;<span class="element">html</span>&gt;
&lt;<span class="element">head</span>&gt;
  &lt;<span class="element">title</span>The Guild of nanoc: a fan website dedicated to nanoc&lt;/<span class="element">title</span>&gt;
&lt;/<span class="element">head</span>&gt;
&lt;<span class="element">body</span>&gt;
&lt;<span class="element">h1</span>&gt;A First Level Header&lt;/<span class="element">h1</span>&gt;

&lt;<span class="element">h2</span>&gt;A Second Level Header&lt;/<span class="element">h2</span>&gt;

&lt;<span class="element">p</span>&gt;Now is the time for all good men to come to
the aid of their country. This is just a
regular paragraph.&lt;/<span class="element">p</span>&gt;

&lt;<span class="element">p</span>&gt;The quick brown fox jumped over the lazy
dog&#x27;s back.&lt;/<span class="element">p</span>&gt;

&lt;<span class="element">h3</span>&gt;Header 3&lt;/<span class="element">h3</span>&gt;

&lt;<span class="element">blockquote</span>&gt;
    &lt;<span class="element">p</span>&gt;This is a blockquote.&lt;/<span class="element">p</span>&gt;

    &lt;<span class="element">p</span>&gt;This is the second paragraph in the blockquote.&lt;/<span class="element">p</span>&gt;

    &lt;<span class="element">h2</span>&gt;This is an H2 in a blockquote&lt;/<span class="element">h2</span>&gt;
&lt;/<span class="element">blockquote</span>&gt;
  &lt;/<span class="element">body</span>&gt;
&lt;/<span class="element">html</span>&gt;</code></pre>
</div>

<div class="section" id="writing-some-custom-code">
	<h3><span>Writing some Custom Code</span></h3>

	<p>There is a directory named <span class="path">lib</span> in your nanoc site. In there, you can throw Ruby source files, and they'll be read and executed before the site is compiled. This is therefore the ideal place to define helper methods. </p>

	<p>As an example, let's add some tags to a few pages, and then let them be displayed in a clean way using a few lines of custom code. Start off by giving the "about" page some tags. Open <span class="path">about.yaml</span> and add this to the end of the "custom" section:</p>

<pre><samp><span class="element">tags</span>:
- <span class="string">"foo"</span>
- <span class="string">"bar"</span>
- <span class="string">"baz"</span></samp></pre>

	<p>Next, create a file named <span class="path">tags.rb</span> in the <span class="path">lib</span> directory. In there, put the following function:</p>

	<pre><code><span class="keyword">def</span> <span class="function">tags</span>
<span class="keyword">if</span> <span class="variable">@page</span>.<span class="function">tags</span>.<span class="function">nil?</span>
  <span class="string">'(none)'</span>
<span class="keyword">else</span>
  <span class="variable">@page</span>.<span class="function">tags</span>.<span class="function">join</span>(<span class="string">', '</span>)
<span class="keyword">end</span>
<span class="keyword">end</span></code></pre>

	<p>This function will take the current page's tags and return a comma-separated list of tags. If there are no tags, it returns "(none)". To put this piece of code to use, open the default layout and add this line right above the <code>&lt;%= @page.content %&gt;</code> line:</p>

	<pre><code>&lt;<span class="element">p</span>&gt;Tags: &lt;%= <span class="function">tags</span> %&gt;&lt;/<span class="element">p</span>&gt;</code></pre>

	<p>Recompile the site, and take a look at both HTML files in the <span class="path">output</span> directory. If all went well, you should see a list of tags right above the page content.</p>

	<p>This example may be a bit weak&mdash;after all, you could simply embed the tag-generating code into the layout directly, like this:</p>

	<pre><code>&lt;<span class="element">p</span>&gt;Tags: &lt;%= <span class="variable">@page</span>.<span class="function">tags</span>.<span class="function">nil?</span> ? <span class="string">'(none)'</span> : <span class="variable">@page</span>.<span class="function">tags</span>.<span class="function">join</span>(<span class="string">', '</span>) %&gt;&lt;/<span class="element">p</span>&gt;</code></pre>

	<p>However, putting embedded Ruby code in HTML can get dirty pretty quickly. This example is still acceptable, but in cases where you need much larger amounts of code, it's best to create a separate function and then call this function where necessary.</p>
</div>

<div class="section" id="watch-out-for-paths">
	<h3><span>Watch out for Paths</span></h3>

	<p>There's one tricky thing involving paths that you need to know. To show you what can go wrong, let's create a stylesheet named <span class="path">style.css</span> in the output directory. Here's what I put in there:</p>

	<pre><code><span class="element">h1</span>, <span class="element">h2</span>, <span class="element">h3</span> { <span class="attribute">color</span>: <span class="value">red</span>; }</code></pre>

	<p>To link the stylesheet to the web site, open the layout (<span class="path">default.erb</span>) and put this in:</p>

	<pre><code>&lt;<span class="element">link <span class="attribute">href</span>=<span class="value">"style.css"</span> <span class="attribute">rel</span>=<span class="value">"stylesheet"</span> <span class="attribute">type</span>=<span class="value">"text/css"</span>></code></pre>

	<p>When you compile the site now and open <span class="path">index.html</span>, you'll see that all headers are red. <span class="path">about/index.html</span>'s headers, however, are not styled—the web browser looks for a <span class="path">about/style.css</span> which doesn't exist.</p>

	<p>The most elegant solution is to use an absolute path, like this (note the new slash):</p>

	<pre><code>&lt;<span class="element">link</span> <span class="attribute">href</span>=<span class="value">"/style.css"</span> <span class="attribute">rel</span>=<span class="value">"stylesheet"</span> <span class="attribute">type</span>=<span class="value">"text/css"</span>></code></pre>

	<p>The compiled files in the output directory will <em>definitely</em> not be styled now if you open them by double-clicking, but that's okay—when the site is put on your web server, web browsers <em>will</em> find the stylesheet.</p>

	<p>This would mean that you can't preview your site locally anymore, but there's a neat solution for that too. nanoc comes with an auto-compiler, which is a web server that compiles pages on-the-fly. More importantly, the output directory is its web root, so absolute paths are no issue anymore. To start it:</p>

	<pre><kbd>nanoc aco</kbd></pre>

	<p>This starts a server on localhost, port 3000 (you can customize the port with <kbd>-p</kbd> if you want). Now you can go to http://localhost:3000/ and absolute paths will pose no problem anymore.</p>
</div>

<div class="section" id="thats-it">
	<h3><span>That's it!</span></h3>

	<p>This is the end of the tutorial. I hope that this tutorial both whet your appetite, and gave you enough information to get started with nanoc.</p>

	<p>There's more reading material. It's definitely worth checking out the <a href="/help/manual/">Manual</a>&mdash;it's rather big, but it contains everything you need to know about nanoc.</p>
</div>
