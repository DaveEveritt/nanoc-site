<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: Nanoc::CompilerDSL
  
    &mdash; Documentation by YARD 0.8.2
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../';
  framesUrl = "../frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


    <link rel="canonical" href="http://nanoc.stoneship.org/docs/api/current/Nanoc/CompilerDSL.html"/>
  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../_index.html">Index (C)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Nanoc.html" title="Nanoc (module)">Nanoc</a></span></span>
     &raquo; 
    <span class="title">CompilerDSL</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
      <div style="margin: 30px 0; padding: 10px; border: 2px solid red; background: #fee"><strong>WARNING:</strong> This documentation applies to nanoc 3.3, which is not the latest version. Please consult the <a href="http://nanoc.stoneship.org/docs/api/current/Nanoc/CompilerDSL.html">up-to-date API documentation</a> instead.</div>

    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Class: Nanoc::CompilerDSL
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Nanoc::CompilerDSL</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/nanoc/base/compilation/compiler_dsl.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>Contains methods that will be executed by the siteâ€™s <code>Rules</code> file.</p>


  </div>
</div>
<div class="tags">
  

</div>






  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#compile-instance_method" title="#compile (instance method)">- (void) <strong>compile</strong>(identifier, params = {}) { ... }</a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Creates a compilation rule for all items whose identifier match the
given identifier, which may either be a string containing the *
wildcard, or a regular expression.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (CompilerDSL) <strong>initialize</strong>(rules_collection, config) </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'><p>Creates a new compiler DSL for the given collection of rules.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#layout-instance_method" title="#layout (instance method)">- (void) <strong>layout</strong>(identifier, filter_name, params = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Creates a layout rule for all layouts whose identifier match the given
identifier, which may either be a string containing the * wildcard, or a
regular expression.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#passthrough-instance_method" title="#passthrough (instance method)">- (void) <strong>passthrough</strong>(identifier, params = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Creates a pair of compilation and routing rules that indicate that the
specified item(s) should be copied to the output folder as-is.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#preprocess-instance_method" title="#preprocess (instance method)">- (void) <strong>preprocess</strong> { ... }</a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Creates a preprocessor block that will be executed after all data is
loaded, but before the site is compiled.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#route-instance_method" title="#route (instance method)">- (void) <strong>route</strong>(identifier, params = {}) { ... }</a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Creates a routing rule for all items whose identifier match the
given identifier, which may either be a string containing the <code>*</code>
wildcard, or a regular expression.</p>
</div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="Nanoc::CompilerDSL (class)">CompilerDSL</a></span></tt>) <strong>initialize</strong>(rules_collection, config) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>
<p>Creates a new compiler DSL for the given collection of rules.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>rules_collection</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="RulesCollection.html" title="Nanoc::RulesCollection (class)">Nanoc::RulesCollection</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The collection of
rules to modify when loading this DSL</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>config</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Hash.html" title="Hash (class)">Hash</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The site configuration</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


16
17
18
19</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/nanoc/base/compilation/compiler_dsl.rb', line 16</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_rules_collection'>rules_collection</span><span class='comma'>,</span> <span class='id identifier rubyid_config'>config</span><span class='rparen'>)</span>
  <span class='ivar'>@rules_collection</span> <span class='op'>=</span> <span class='id identifier rubyid_rules_collection'>rules_collection</span>
  <span class='ivar'>@config</span> <span class='op'>=</span> <span class='id identifier rubyid_config'>config</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="compile-instance_method">
  
    - (<tt>void</tt>) <strong>compile</strong>(identifier, params = {}) { ... }
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p><p>Creates a compilation rule for all items whose identifier match the
given identifier, which may either be a string containing the *
wildcard, or a regular expression.</p>

<p>This rule will be applicable to reps with a name equal to <code>:default</code>;
this can be changed by giving an explicit <code>:rep</code> parameter.</p>

<p>An item rep will be compiled by calling the given block and passing the
rep as a block argument.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'><p>Compiling the default rep of the <code>/foo/</code> item</p>
</div></p>
      
      <pre class="example code">
<span class='id identifier rubyid_compile'>compile</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>/foo/</span><span class='tstring_end'>'</span></span> <span class='kw'>do</span>
  <span class='id identifier rubyid_rep'>rep</span><span class='period'>.</span><span class='id identifier rubyid_filter'>filter</span> <span class='symbol'>:erb</span>
<span class='kw'>end</span></pre>
    
      
        <p class="example_title"><div class='inline'><p>Compiling the <code>:raw</code> rep of the <code>/bar/</code> item</p>
</div></p>
      
      <pre class="example code">
<span class='id identifier rubyid_compile'>compile</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>/bar/</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='symbol'>:rep</span> <span class='op'>=&gt;</span> <span class='symbol'>:raw</span> <span class='kw'>do</span>
  <span class='comment'># do nothing
</span><span class='kw'>end</span></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>identifier</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>A pattern matching identifiers of items that
should be compiled using this rule</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>params</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Hash.html" title="Hash (class)">Hash</a></span></tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>a customizable set of options</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>params</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:rep</span>
          <span class="type">(<tt>Symbol</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>:default</tt>
            
          </span>
          
            &mdash; <div class='inline'><p>The name of the representation
that should be compiled using this rule</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'><p>The block that will be executed when an item matching this
compilation rule needs to be compiled</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>ArgumentError</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


63
64
65
66
67
68
69
70
71
72
73</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/nanoc/base/compilation/compiler_dsl.rb', line 63</span>

<span class='kw'>def</span> <span class='id identifier rubyid_compile'>compile</span><span class='lparen'>(</span><span class='id identifier rubyid_identifier'>identifier</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='comment'># Require block
</span>  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>#compile requires a block</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_block_given?'>block_given?</span>

  <span class='comment'># Get rep name
</span>  <span class='id identifier rubyid_rep_name'>rep_name</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:rep</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='symbol'>:default</span>

  <span class='comment'># Create rule
</span>  <span class='id identifier rubyid_rule'>rule</span> <span class='op'>=</span> <span class='const'>Rule</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_identifier_to_regex'>identifier_to_regex</span><span class='lparen'>(</span><span class='id identifier rubyid_identifier'>identifier</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_rep_name'>rep_name</span><span class='comma'>,</span> <span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='ivar'>@rules_collection</span><span class='period'>.</span><span class='id identifier rubyid_add_item_compilation_rule'>add_item_compilation_rule</span><span class='lparen'>(</span><span class='id identifier rubyid_rule'>rule</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="layout-instance_method">
  
    - (<tt>void</tt>) <strong>layout</strong>(identifier, filter_name, params = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p><p>Creates a layout rule for all layouts whose identifier match the given
identifier, which may either be a string containing the * wildcard, or a
regular expression. The layouts matching the identifier will be filtered
using the filter specified in the second argument. The params hash
contains filter arguments that will be passed to the filter.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'><p>Specifying the filter to use for a layout</p>
</div></p>
      
      <pre class="example code">
<span class='id identifier rubyid_layout'>layout</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>/default/</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='symbol'>:erb</span></pre>
    
      
        <p class="example_title"><div class='inline'><p>Using custom filter arguments for a layout</p>
</div></p>
      
      <pre class="example code">
<span class='id identifier rubyid_layout'>layout</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>/custom/</span><span class='tstring_end'>'</span></span><span class='comma'>,</span>  <span class='symbol'>:haml</span><span class='comma'>,</span> <span class='symbol'>:format</span> <span class='op'>=&gt;</span> <span class='symbol'>:html5</span></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>identifier</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>A pattern matching identifiers of layouts
that should be filtered using this rule</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>filter_name</span>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The name of the filter that should be run
when processing the layout</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>params</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Hash.html" title="Hash (class)">Hash</a></span></tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Extra filter arguments that should be passed to the
filter when processing the layout (see <span class='object_link'><a href="Filter.html#run-instance_method" title="Nanoc::Filter#run (method)">Filter#run</a></span>)</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


144
145
146</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/nanoc/base/compilation/compiler_dsl.rb', line 144</span>

<span class='kw'>def</span> <span class='id identifier rubyid_layout'>layout</span><span class='lparen'>(</span><span class='id identifier rubyid_identifier'>identifier</span><span class='comma'>,</span> <span class='id identifier rubyid_filter_name'>filter_name</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='ivar'>@rules_collection</span><span class='period'>.</span><span class='id identifier rubyid_layout_filter_mapping'>layout_filter_mapping</span><span class='lbracket'>[</span><span class='id identifier rubyid_identifier_to_regex'>identifier_to_regex</span><span class='lparen'>(</span><span class='id identifier rubyid_identifier'>identifier</span><span class='rparen'>)</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbracket'>[</span> <span class='id identifier rubyid_filter_name'>filter_name</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span> <span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="passthrough-instance_method">
  
    - (<tt>void</tt>) <strong>passthrough</strong>(identifier, params = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p><p>Creates a pair of compilation and routing rules that indicate that the
specified item(s) should be copied to the output folder as-is. The items
are selected using an identifier, which may either be a string
containing the <code>*</code> wildcard, or a regular expression.</p>

<p>This meta-rule will be applicable to reps with a name equal to
<code>:default</code>; this can be changed by giving an explicit <code>:rep</code> parameter.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'><p>Copying the <code>/foo/</code> item as-is</p>
</div></p>
      
      <pre class="example code">
<span class='id identifier rubyid_passthrough'>passthrough</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>/foo/</span><span class='tstring_end'>'</span></span></pre>
    
      
        <p class="example_title"><div class='inline'><p>Copying the <code>:raw</code> rep of the <code>/bar/</code> item as-is</p>
</div></p>
      
      <pre class="example code">
<span class='id identifier rubyid_passthrough'>passthrough</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>/bar/</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='symbol'>:rep</span> <span class='op'>=&gt;</span> <span class='symbol'>:raw</span></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>identifier</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>A pattern matching identifiers of items that
should be processed using this meta-rule</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>params</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Hash.html" title="Hash (class)">Hash</a></span></tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>a customizable set of options</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>params</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:rep</span>
          <span class="type">(<tt>Symbol</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>:default</tt>
            
          </span>
          
            &mdash; <div class='inline'><p>The name of the representation
that should be routed using this rule</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>ArgumentError</tt>)</span>
      
      
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>3.2.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/nanoc/base/compilation/compiler_dsl.rb', line 173</span>

<span class='kw'>def</span> <span class='id identifier rubyid_passthrough'>passthrough</span><span class='lparen'>(</span><span class='id identifier rubyid_identifier'>identifier</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='comment'># Require no block
</span>  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>#passthrough does not require a block</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>

  <span class='comment'># Get rep name
</span>  <span class='id identifier rubyid_rep_name'>rep_name</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:rep</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='symbol'>:default</span>

  <span class='comment'># Create compilation rule
</span>  <span class='id identifier rubyid_compilation_block'>compilation_block</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> <span class='lbrace'>{</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_compilation_rule'>compilation_rule</span> <span class='op'>=</span> <span class='const'>Rule</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_identifier_to_regex'>identifier_to_regex</span><span class='lparen'>(</span><span class='id identifier rubyid_identifier'>identifier</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_rep_name'>rep_name</span><span class='comma'>,</span> <span class='id identifier rubyid_compilation_block'>compilation_block</span><span class='rparen'>)</span>
  <span class='ivar'>@rules_collection</span><span class='period'>.</span><span class='id identifier rubyid_add_item_compilation_rule'>add_item_compilation_rule</span><span class='lparen'>(</span><span class='id identifier rubyid_compilation_rule'>compilation_rule</span><span class='comma'>,</span> <span class='symbol'>:before</span><span class='rparen'>)</span>

  <span class='comment'># Create routing rule
</span>  <span class='id identifier rubyid_routing_block'>routing_block</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_item'>item</span><span class='period'>.</span><span class='id identifier rubyid_identifier'>identifier</span><span class='period'>.</span><span class='id identifier rubyid_chop'>chop</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>.</span><span class='tstring_end'>'</span></span> <span class='op'>+</span> <span class='id identifier rubyid_item'>item</span><span class='lbracket'>[</span><span class='symbol'>:extension</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_routing_rule'>routing_rule</span> <span class='op'>=</span> <span class='const'>Rule</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_identifier_to_regex'>identifier_to_regex</span><span class='lparen'>(</span><span class='id identifier rubyid_identifier'>identifier</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_rep_name'>rep_name</span><span class='comma'>,</span> <span class='id identifier rubyid_routing_block'>routing_block</span><span class='rparen'>)</span>
  <span class='ivar'>@rules_collection</span><span class='period'>.</span><span class='id identifier rubyid_add_item_routing_rule'>add_item_routing_rule</span><span class='lparen'>(</span><span class='id identifier rubyid_routing_rule'>routing_rule</span><span class='comma'>,</span> <span class='symbol'>:before</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="preprocess-instance_method">
  
    - (<tt>void</tt>) <strong>preprocess</strong> { ... }
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p><p>Creates a preprocessor block that will be executed after all data is
loaded, but before the site is compiled.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'><p>The block that will be executed before site compilation starts</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


27
28
29</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/nanoc/base/compilation/compiler_dsl.rb', line 27</span>

<span class='kw'>def</span> <span class='id identifier rubyid_preprocess'>preprocess</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='ivar'>@rules_collection</span><span class='period'>.</span><span class='id identifier rubyid_preprocessor'>preprocessor</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="route-instance_method">
  
    - (<tt>void</tt>) <strong>route</strong>(identifier, params = {}) { ... }
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p><p>Creates a routing rule for all items whose identifier match the
given identifier, which may either be a string containing the <code>*</code>
wildcard, or a regular expression.</p>

<p>This rule will be applicable to reps with a name equal to <code>:default</code>;
this can be changed by giving an explicit <code>:rep</code> parameter.</p>

<p>The path of an item rep will be determined by calling the given block
and passing the rep as a block argument.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'><p>Routing the default rep of the <code>/foo/</code> item</p>
</div></p>
      
      <pre class="example code">
<span class='id identifier rubyid_route'>route</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>/foo/</span><span class='tstring_end'>'</span></span> <span class='kw'>do</span>
  <span class='id identifier rubyid_item'>item</span><span class='period'>.</span><span class='id identifier rubyid_identifier'>identifier</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>index.html</span><span class='tstring_end'>'</span></span>
<span class='kw'>end</span></pre>
    
      
        <p class="example_title"><div class='inline'><p>Routing the <code>:raw</code> rep of the <code>/bar/</code> item</p>
</div></p>
      
      <pre class="example code">
<span class='id identifier rubyid_route'>route</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>/bar/</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='symbol'>:rep</span> <span class='op'>=&gt;</span> <span class='symbol'>:raw</span> <span class='kw'>do</span>
  <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>/raw</span><span class='tstring_end'>'</span></span> <span class='op'>+</span> <span class='id identifier rubyid_item'>item</span><span class='period'>.</span><span class='id identifier rubyid_identifier'>identifier</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>index.txt</span><span class='tstring_end'>'</span></span>
<span class='kw'>end</span></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>identifier</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>A pattern matching identifiers of items that
should be routed using this rule</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>params</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Hash.html" title="Hash (class)">Hash</a></span></tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>a customizable set of options</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>params</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:rep</span>
          <span class="type">(<tt>Symbol</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>:default</tt>
            
          </span>
          
            &mdash; <div class='inline'><p>The name of the representation
that should be routed using this rule</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'><p>The block that will be executed when an item matching this
compilation rule needs to be routed</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>ArgumentError</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


107
108
109
110
111
112
113
114
115
116
117
118</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/nanoc/base/compilation/compiler_dsl.rb', line 107</span>

<span class='kw'>def</span> <span class='id identifier rubyid_route'>route</span><span class='lparen'>(</span><span class='id identifier rubyid_identifier'>identifier</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='comment'># Require block
</span>  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>#route requires a block</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_block_given?'>block_given?</span>

  <span class='comment'># Get rep name
</span>  <span class='id identifier rubyid_rep_name'>rep_name</span>      <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:rep</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='symbol'>:default</span>
  <span class='id identifier rubyid_snapshot_name'>snapshot_name</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:snapshot</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='symbol'>:last</span>

  <span class='comment'># Create rule
</span>  <span class='id identifier rubyid_rule'>rule</span> <span class='op'>=</span> <span class='const'>Rule</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_identifier_to_regex'>identifier_to_regex</span><span class='lparen'>(</span><span class='id identifier rubyid_identifier'>identifier</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_rep_name'>rep_name</span><span class='comma'>,</span> <span class='id identifier rubyid_block'>block</span><span class='comma'>,</span> <span class='symbol'>:snapshot_name</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_snapshot_name'>snapshot_name</span><span class='rparen'>)</span>
  <span class='ivar'>@rules_collection</span><span class='period'>.</span><span class='id identifier rubyid_add_item_routing_rule'>add_item_routing_rule</span><span class='lparen'>(</span><span class='id identifier rubyid_rule'>rule</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-15639968-1");
pageTracker._trackPageview();
} catch(err) {}</script>

  </body>
</html>
