<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" href="../../style.css" type="text/css" charset="utf-8" />
<link rel="stylesheet" href="../../custom.css" type="text/css" charset="utf-8" />
<link rel="stylesheet" href="../../syntax_highlight.css" type="text/css" charset="utf-8" />

    <script src="../../jquery.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../app.js" type="text/javascript" charset="utf-8"></script>
    <title>Module: Nanoc3::Helpers::Blogging</title>
  </head>
  <body>
    <div id="content">
      <div class="section module Nanoc3_Helpers_Blogging">
  <h1 class="title">Module: Nanoc3::Helpers::Blogging</h1>
  <div class="section docstring">
  <p>
Nanoc3::Helpers::Blogging provides some functionality for building blogs,
such as finding articles and constructing feeds.
</p>
<p>
This helper has a few requirements. First, all blog articles should have
the following attributes:
</p>
<ul>
<li>&#8216;kind&#8217;, set to &#8216;article&#8217;.

</li>
<li>&#8216;created_at&#8217;, set to the creation timestamp.

</li>
</ul>
<p>
Some functions in this blogging helper, such as the <tt>atom_feed</tt>
function, require additional attributes to be set; these attributes are
described in the documentation for these functions.
</p>
<p>
The two main functions are sorted_articles and atom_feed.
</p>
<p>
To activate this helper, <tt>include</tt> it, like this:
</p>
<pre class="code">
  <span class='include identifier id'>include</span> <span class='Nanoc3 constant id'>Nanoc3</span><span class='colon2 op'>::</span><span class='Helpers constant id'>Helpers</span><span class='colon2 op'>::</span><span class='Blogging constant id'>Blogging</span>
</pre>

</div><div class="section constants">
  
</div>  <div class="section visibilitygroup public">
    <h1>Public Visibility</h1>
      <div class="section methodsummary instance public">
    <h1>Public Instance Method Summary</h1>
<table class="summary">
  
    <tr>
      <th class="signature">
        
          <span class='overload'>
            <span class='name'><a href="#articles-instance_method" title="#articles">#articles</a></span><span class='args'></span>
            <span class='block'></span>
          </span>
        
        
      </th>
      <td class="docstring">
        <p>
Returns an unsorted list of articles.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        
          <span class='overload'>
            <span class='name'><a href="#atom_feed-instance_method" title="#atom_feed">#atom_feed</a></span><span class='args'>(params = {})</span>
            <span class='block'></span>
          </span>
        
        
      </th>
      <td class="docstring">
        <p>
Returns a string representing the atom feed containing recent articles,
sorted by descending creation date.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        
          <span class='overload'>
            <span class='name'><a href="#atom_tag_for-instance_method" title="#atom_tag_for">#atom_tag_for</a></span><span class='args'>(item)</span>
            <span class='block'></span>
          </span>
        
        
      </th>
      <td class="docstring">
        <p>
Returns an URI containing an unique ID for the given item.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        
          <span class='overload'>
            <span class='name'><a href="#feed_url-instance_method" title="#feed_url">#feed_url</a></span><span class='args'></span>
            <span class='block'></span>
          </span>
        
        
      </th>
      <td class="docstring">
        <p>
Returns the URL of the feed.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        
          <span class='overload'>
            <span class='name'><a href="#sorted_articles-instance_method" title="#sorted_articles">#sorted_articles</a></span><span class='args'></span>
            <span class='block'></span>
          </span>
        
        
      </th>
      <td class="docstring">
        <p>
Returns a list of articles, sorted by descending creation date (so newer
articles appear first).
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        
          <span class='overload'>
            <span class='name'><a href="#url_for-instance_method" title="#url_for">#url_for</a></span><span class='args'>(item)</span>
            <span class='block'></span>
          </span>
        
        
      </th>
      <td class="docstring">
        <p>
Returns the URL for the given item.
</p>

        
      </td>
    </tr>
  
</table>

  </div>
<div class="section methoddetails instance public">
  <h1>Public Instance Method Details</h1>
  
    <div class="method">
      <div class="method_header">
  <h3>articles</h3>
</div><div id="articles-instance_method" class="section method">
  <div class="details_title">
    <div class='section methodsignature'>
    <tt class='def'>
      <span class='visibility'>public</span>
      <span class='return_types'></span>
      <span class='name'>articles</span><span class='args'></span>
      <span class='block'></span>
    </tt>
  </div>

</div><div class="section docstring">
  <p>
Returns an unsorted list of articles.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


27
28
29</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/nanoc3/helpers/blogging.rb', line 27</span>

<span class='def def kw'>def</span> <span class='articles identifier id'>articles</span>
  <span class='@items ivar id'>@items</span><span class='dot token'>.</span><span class='select identifier id'>select</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='item identifier id'>item</span><span class='bitor op'>|</span> <span class='item identifier id'>item</span><span class='lbrack token'>[</span><span class='symbol val'>:kind</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='string val'>'article'</span> <span class='rbrace token'>}</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>atom_feed</h3>
</div><div id="atom_feed-instance_method" class="section method">
  <div class="details_title">
    <div class='section methodsignature'>
    <tt class='def'>
      <span class='visibility'>public</span>
      <span class='return_types'></span>
      <span class='name'>atom_feed</span><span class='args'>(params = {})</span>
      <span class='block'></span>
    </tt>
  </div>

</div><div class="section docstring">
  <p>
Returns a string representing the atom feed containing recent articles,
sorted by descending creation date. <tt>params</tt> is a hash where the
following keys can be set:
</p>
<table>
<tr><td valign="top"><tt>limit</tt>:</td><td>The maximum number of articles to show. Defaults to 5.

</td></tr>
<tr><td valign="top"><tt>articles</tt>:</td><td>A list of articles to include in the feed. Defaults to the list of articles
returned by the articles function.

</td></tr>
<tr><td valign="top"><tt>content_proc</tt>:</td><td>A proc that returns the content of the given article, passed as a
parameter. By default, given the argument <tt>article</tt>, this proc will
return <tt>article.reps[0].content</tt>. This function may not return nil.

</td></tr>
<tr><td valign="top"><tt>excerpt_proc</tt>:</td><td>A proc that returns the excerpt of the given article, passed as a
parameter. By default, given the argument <tt>article</tt>, this proc will
return <tt>article.excerpt</tt>. This function may return nil.

</td></tr>
</table>
<p>
The following attributes must be set on blog articles:
</p>
<ul>
<li>&#8216;title&#8217;, containing the title of the blog post.

</li>
<li>all other attributes mentioned above.

</li>
</ul>
<p>
The following attributes can optionally be set on blog articles to change
the behaviour of the Atom feed:
</p>
<ul>
<li>&#8216;excerpt&#8217;, containing an excerpt of the article, usually only a
few lines long.

</li>
<li>&#8216;custom_path_in_feed&#8217;, containing the path that will be used
instead of the normal path in the feed. This can be useful when including
non-outputted items in a feed; such items could have their custom feed path
set to the blog path instead, for example.

</li>
</ul>
<p>
The feed will also include dates on which the articles were updated. These
are generated automatically; the way this happens depends on the used data
source (the filesystem data source checks the file mtimes, for instance).
</p>
<p>
The site configuration will need to have the following attributes:
</p>
<ul>
<li>&#8216;base_url&#8217;, containing the URL to the site, without trailing
slash. For example, if the site is at &quot;http://example.com/&quot;, the
base_url would be &quot;http://example.com&quot;.

</li>
</ul>
<p>
The feed item will need to have the following attributes:
</p>
<ul>
<li>&#8216;title&#8217;, containing the title of the feed, which is usually
also the title of the blog.

</li>
<li>&#8216;author_name&#8217;, containing the name of the item&#8217;s author.
This will likely be a global attribute, unless the site is managed by
several people/

</li>
<li>&#8216;author_uri&#8217;, containing the URI for the item&#8217;s author,
such as the author&#8217;s web site URL. This will also likely be a global
attribute.

</li>
</ul>
<p>
The feed item can have the following optional attributes:
</p>
<ul>
<li>&#8216;feed_url&#8217;, containing the custom URL of the feed. This can be
useful when the private feed URL shouldn&#8217;t be exposed; for example,
when using FeedBurner this would be set to the public FeedBurner URL.

</li>
</ul>
<p>
To construct a feed, create a blank item with no layout, only the
&#8216;erb&#8217; (or &#8216;erubis&#8217;) filter, and an
&#8216;xml&#8217; extension. It may also be useful to set
&#8216;is_hidden&#8217; to true, so that helpers such as the sitemap helper
will ignore the item. The content of the feed item should be:
</p>
<pre class="code">
  <span class='lt op'>&lt;</span><span class='string val'>%= atom_feed %&gt;
</span></pre>

</div><div class="section tags">
  <h2>Meta Tags</h2>
  <div class="raise">
  <h3>Raises:</h3>
  <dl>
  
    <dt>
      
        <span class='type'>[<tt>RuntimeError</tt>]</span>
      
      
      
    </dt>
    <dd>
      <span class='desc'></span>
    </dd>
  
  </dl>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/nanoc3/helpers/blogging.rb', line 110</span>

<span class='def def kw'>def</span> <span class='atom_feed identifier id'>atom_feed</span><span class='lparen token'>(</span><span class='params identifier id'>params</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='require identifier id'>require</span> <span class='string val'>'builder'</span>
  <span class='require identifier id'>require</span> <span class='string val'>'time'</span>

  <span class='comment val'># Extract parameters</span>
  <span class='limit identifier id'>limit</span>             <span class='assign token'>=</span> <span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:limit</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='integer val'>5</span>
  <span class='relevant_articles identifier id'>relevant_articles</span> <span class='assign token'>=</span> <span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:articles</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='articles identifier id'>articles</span> <span class='orop op'>||</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='content_proc identifier id'>content_proc</span>      <span class='assign token'>=</span> <span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:content_proc</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='lambda identifier id'>lambda</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='a identifier id'>a</span><span class='bitor op'>|</span> <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='reps identifier id'>reps</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='content_at_snapshot identifier id'>content_at_snapshot</span><span class='lparen token'>(</span><span class='symbol val'>:pre</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
  <span class='excerpt_proc identifier id'>excerpt_proc</span>      <span class='assign token'>=</span> <span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:excerpt_proc</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='lambda identifier id'>lambda</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='a identifier id'>a</span><span class='bitor op'>|</span> <span class='a identifier id'>a</span><span class='lbrack token'>[</span><span class='symbol val'>:excerpt</span><span class='rbrack token'>]</span> <span class='rbrace token'>}</span>

  <span class='comment val'># Check config attributes</span>
  <span class='if if kw'>if</span> <span class='@site ivar id'>@site</span><span class='dot token'>.</span><span class='config identifier id'>config</span><span class='lbrack token'>[</span><span class='symbol val'>:base_url</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
    <span class='raise identifier id'>raise</span> <span class='RuntimeError constant id'>RuntimeError</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>'Cannot build Atom feed: site configuration has no base_url'</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Check feed item attributes</span>
  <span class='if if kw'>if</span> <span class='@item ivar id'>@item</span><span class='lbrack token'>[</span><span class='symbol val'>:title</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
    <span class='raise identifier id'>raise</span> <span class='RuntimeError constant id'>RuntimeError</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>'Cannot build Atom feed: feed item has no title'</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='if if kw'>if</span> <span class='@item ivar id'>@item</span><span class='lbrack token'>[</span><span class='symbol val'>:author_name</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
    <span class='raise identifier id'>raise</span> <span class='RuntimeError constant id'>RuntimeError</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>'Cannot build Atom feed: feed item has no author_name'</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='if if kw'>if</span> <span class='@item ivar id'>@item</span><span class='lbrack token'>[</span><span class='symbol val'>:author_uri</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
    <span class='raise identifier id'>raise</span> <span class='RuntimeError constant id'>RuntimeError</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>'Cannot build Atom feed: feed item has no author_uri'</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Check article attributes</span>
  <span class='if if kw'>if</span> <span class='relevant_articles identifier id'>relevant_articles</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span>
    <span class='raise identifier id'>raise</span> <span class='RuntimeError constant id'>RuntimeError</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>'Cannot build Atom feed: no articles'</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='if if kw'>if</span> <span class='relevant_articles identifier id'>relevant_articles</span><span class='dot token'>.</span><span class='any? fid id'>any?</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='a identifier id'>a</span><span class='bitor op'>|</span> <span class='a identifier id'>a</span><span class='lbrack token'>[</span><span class='symbol val'>:created_at</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='rbrace token'>}</span>
    <span class='raise identifier id'>raise</span> <span class='RuntimeError constant id'>RuntimeError</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>'Cannot build Atom feed: one or more articles lack created_at'</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Get sorted relevant articles</span>
  <span class='sorted_relevant_articles identifier id'>sorted_relevant_articles</span> <span class='assign token'>=</span> <span class='relevant_articles identifier id'>relevant_articles</span><span class='dot token'>.</span><span class='sort_by identifier id'>sort_by</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='a identifier id'>a</span><span class='bitor op'>|</span> <span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='parse identifier id'>parse</span><span class='lparen token'>(</span><span class='a identifier id'>a</span><span class='lbrack token'>[</span><span class='symbol val'>:created_at</span><span class='rbrack token'>]</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='reverse identifier id'>reverse</span><span class='dot token'>.</span><span class='first identifier id'>first</span><span class='lparen token'>(</span><span class='limit identifier id'>limit</span><span class='rparen token'>)</span>

  <span class='comment val'># Get most recent article</span>
  <span class='last_article identifier id'>last_article</span> <span class='assign token'>=</span> <span class='sorted_relevant_articles identifier id'>sorted_relevant_articles</span><span class='dot token'>.</span><span class='first identifier id'>first</span>

  <span class='comment val'># Create builder</span>
  <span class='buffer identifier id'>buffer</span> <span class='assign token'>=</span> <span class='string val'>''</span>
  <span class='xml identifier id'>xml</span> <span class='assign token'>=</span> <span class='Builder constant id'>Builder</span><span class='colon2 op'>::</span><span class='XmlMarkup constant id'>XmlMarkup</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='symbol val'>:target</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='buffer identifier id'>buffer</span><span class='comma token'>,</span> <span class='symbol val'>:indent</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>2</span><span class='rparen token'>)</span>

  <span class='comment val'># Build feed</span>
  <span class='xml identifier id'>xml</span><span class='dot token'>.</span><span class='instruct! fid id'>instruct!</span>
  <span class='xml identifier id'>xml</span><span class='dot token'>.</span><span class='feed identifier id'>feed</span><span class='lparen token'>(</span><span class='symbol val'>:xmlns</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'http://www.w3.org/2005/Atom'</span><span class='rparen token'>)</span> <span class='do do kw'>do</span>
    <span class='comment val'># Add primary attributes</span>
    <span class='xml identifier id'>xml</span><span class='dot token'>.</span><span class='id identifier id'>id</span>      <span class='@site ivar id'>@site</span><span class='dot token'>.</span><span class='config identifier id'>config</span><span class='lbrack token'>[</span><span class='symbol val'>:base_url</span><span class='rbrack token'>]</span> <span class='plus op'>+</span> <span class='string val'>'/'</span>
    <span class='xml identifier id'>xml</span><span class='dot token'>.</span><span class='title identifier id'>title</span>   <span class='@item ivar id'>@item</span><span class='lbrack token'>[</span><span class='symbol val'>:title</span><span class='rbrack token'>]</span>

    <span class='comment val'># Add date</span>
    <span class='xml identifier id'>xml</span><span class='dot token'>.</span><span class='updated identifier id'>updated</span> <span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='parse identifier id'>parse</span><span class='lparen token'>(</span><span class='last_article identifier id'>last_article</span><span class='lbrack token'>[</span><span class='symbol val'>:created_at</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_iso8601_time identifier id'>to_iso8601_time</span>

    <span class='comment val'># Add links</span>
    <span class='xml identifier id'>xml</span><span class='dot token'>.</span><span class='link identifier id'>link</span><span class='lparen token'>(</span><span class='symbol val'>:rel</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'alternate'</span><span class='comma token'>,</span> <span class='symbol val'>:href</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='@site ivar id'>@site</span><span class='dot token'>.</span><span class='config identifier id'>config</span><span class='lbrack token'>[</span><span class='symbol val'>:base_url</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
    <span class='xml identifier id'>xml</span><span class='dot token'>.</span><span class='link identifier id'>link</span><span class='lparen token'>(</span><span class='symbol val'>:rel</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'self'</span><span class='comma token'>,</span>      <span class='symbol val'>:href</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='feed_url identifier id'>feed_url</span><span class='rparen token'>)</span>

    <span class='comment val'># Add author information</span>
    <span class='xml identifier id'>xml</span><span class='dot token'>.</span><span class='author identifier id'>author</span> <span class='do do kw'>do</span>
      <span class='xml identifier id'>xml</span><span class='dot token'>.</span><span class='name identifier id'>name</span>  <span class='@item ivar id'>@item</span><span class='lbrack token'>[</span><span class='symbol val'>:author_name</span><span class='rbrack token'>]</span>
      <span class='xml identifier id'>xml</span><span class='dot token'>.</span><span class='uri identifier id'>uri</span>   <span class='@item ivar id'>@item</span><span class='lbrack token'>[</span><span class='symbol val'>:author_uri</span><span class='rbrack token'>]</span>
    <span class='end end kw'>end</span>

    <span class='comment val'># Add articles</span>
    <span class='sorted_relevant_articles identifier id'>sorted_relevant_articles</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='a identifier id'>a</span><span class='bitor op'>|</span>
      <span class='xml identifier id'>xml</span><span class='dot token'>.</span><span class='entry identifier id'>entry</span> <span class='do do kw'>do</span>
        <span class='comment val'># Add primary attributes</span>
        <span class='xml identifier id'>xml</span><span class='dot token'>.</span><span class='id identifier id'>id</span>        <span class='atom_tag_for identifier id'>atom_tag_for</span><span class='lparen token'>(</span><span class='a identifier id'>a</span><span class='rparen token'>)</span>
        <span class='xml identifier id'>xml</span><span class='dot token'>.</span><span class='title identifier id'>title</span>     <span class='a identifier id'>a</span><span class='lbrack token'>[</span><span class='symbol val'>:title</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='symbol val'>:type</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'html'</span>

        <span class='comment val'># Add dates</span>
        <span class='xml identifier id'>xml</span><span class='dot token'>.</span><span class='published identifier id'>published</span> <span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='parse identifier id'>parse</span><span class='lparen token'>(</span><span class='a identifier id'>a</span><span class='lbrack token'>[</span><span class='symbol val'>:created_at</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_iso8601_time identifier id'>to_iso8601_time</span>
        <span class='xml identifier id'>xml</span><span class='dot token'>.</span><span class='updated identifier id'>updated</span>   <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='mtime identifier id'>mtime</span><span class='dot token'>.</span><span class='to_iso8601_time identifier id'>to_iso8601_time</span>

        <span class='comment val'># Add link</span>
        <span class='xml identifier id'>xml</span><span class='dot token'>.</span><span class='link identifier id'>link</span><span class='lparen token'>(</span><span class='symbol val'>:rel</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'alternate'</span><span class='comma token'>,</span> <span class='symbol val'>:href</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='url_for identifier id'>url_for</span><span class='lparen token'>(</span><span class='a identifier id'>a</span><span class='rparen token'>)</span><span class='rparen token'>)</span>

        <span class='comment val'># Add content</span>
        <span class='summary identifier id'>summary</span> <span class='assign token'>=</span> <span class='excerpt_proc identifier id'>excerpt_proc</span><span class='dot token'>.</span><span class='call identifier id'>call</span><span class='lparen token'>(</span><span class='a identifier id'>a</span><span class='rparen token'>)</span>
        <span class='xml identifier id'>xml</span><span class='dot token'>.</span><span class='content identifier id'>content</span>   <span class='content_proc identifier id'>content_proc</span><span class='dot token'>.</span><span class='call identifier id'>call</span><span class='lparen token'>(</span><span class='a identifier id'>a</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='symbol val'>:type</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'html'</span>
        <span class='xml identifier id'>xml</span><span class='dot token'>.</span><span class='summary identifier id'>summary</span>   <span class='summary identifier id'>summary</span><span class='comma token'>,</span> <span class='symbol val'>:type</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'html'</span> <span class='unless unless_mod kw'>unless</span> <span class='summary identifier id'>summary</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='buffer identifier id'>buffer</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>atom_tag_for</h3>
</div><div id="atom_tag_for-instance_method" class="section method">
  <div class="details_title">
    <div class='section methodsignature'>
    <tt class='def'>
      <span class='visibility'>public</span>
      <span class='return_types'></span>
      <span class='name'>atom_tag_for</span><span class='args'>(item)</span>
      <span class='block'></span>
    </tt>
  </div>

</div><div class="section docstring">
  <p>
Returns an URI containing an unique ID for the given item. This will be
used in the Atom feed to uniquely identify articles. These IDs are created
using a procedure suggested by Mark Pilgrim in this blog post:
http://diveintomark.org/archives/2004/05/28/howto-atom-id.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


215
216
217
218
219
220
221
222</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/nanoc3/helpers/blogging.rb', line 215</span>

<span class='def def kw'>def</span> <span class='atom_tag_for identifier id'>atom_tag_for</span><span class='lparen token'>(</span><span class='item identifier id'>item</span><span class='rparen token'>)</span>
  <span class='require identifier id'>require</span> <span class='string val'>'time'</span>

  <span class='hostname identifier id'>hostname</span>        <span class='assign token'>=</span> <span class='@site ivar id'>@site</span><span class='dot token'>.</span><span class='config identifier id'>config</span><span class='lbrack token'>[</span><span class='symbol val'>:base_url</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='sub identifier id'>sub</span><span class='lparen token'>(</span><span class='regexp val'>/.*:\/\/(.+?)\/?$/</span><span class='comma token'>,</span> <span class='string val'>'\1'</span><span class='rparen token'>)</span>
  <span class='formatted_date identifier id'>formatted_date</span>  <span class='assign token'>=</span> <span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='parse identifier id'>parse</span><span class='lparen token'>(</span><span class='item identifier id'>item</span><span class='lbrack token'>[</span><span class='symbol val'>:created_at</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_iso8601_date identifier id'>to_iso8601_date</span>

  <span class='string val'>'tag:'</span> <span class='plus op'>+</span> <span class='hostname identifier id'>hostname</span> <span class='plus op'>+</span> <span class='string val'>','</span> <span class='plus op'>+</span> <span class='formatted_date identifier id'>formatted_date</span> <span class='plus op'>+</span> <span class='string val'>':'</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='item identifier id'>item</span><span class='dot token'>.</span><span class='reps identifier id'>reps</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='path identifier id'>path</span> <span class='orop op'>||</span> <span class='item identifier id'>item</span><span class='dot token'>.</span><span class='identifier identifier id'>identifier</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>feed_url</h3>
</div><div id="feed_url-instance_method" class="section method">
  <div class="details_title">
    <div class='section methodsignature'>
    <tt class='def'>
      <span class='visibility'>public</span>
      <span class='return_types'></span>
      <span class='name'>feed_url</span><span class='args'></span>
      <span class='block'></span>
    </tt>
  </div>

</div><div class="section docstring">
  <p>
Returns the URL of the feed. It will return the custom feed URL if set, or
otherwise the normal feed URL.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


207
208
209</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/nanoc3/helpers/blogging.rb', line 207</span>

<span class='def def kw'>def</span> <span class='feed_url identifier id'>feed_url</span>
  <span class='@item ivar id'>@item</span><span class='lbrack token'>[</span><span class='symbol val'>:feed_url</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='@site ivar id'>@site</span><span class='dot token'>.</span><span class='config identifier id'>config</span><span class='lbrack token'>[</span><span class='symbol val'>:base_url</span><span class='rbrack token'>]</span> <span class='plus op'>+</span> <span class='@item ivar id'>@item</span><span class='dot token'>.</span><span class='reps identifier id'>reps</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='path identifier id'>path</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>sorted_articles</h3>
</div><div id="sorted_articles-instance_method" class="section method">
  <div class="details_title">
    <div class='section methodsignature'>
    <tt class='def'>
      <span class='visibility'>public</span>
      <span class='return_types'></span>
      <span class='name'>sorted_articles</span><span class='args'></span>
      <span class='block'></span>
    </tt>
  </div>

</div><div class="section docstring">
  <p>
Returns a list of articles, sorted by descending creation date (so newer
articles appear first).
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


33
34
35
36</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/nanoc3/helpers/blogging.rb', line 33</span>

<span class='def def kw'>def</span> <span class='sorted_articles identifier id'>sorted_articles</span>
  <span class='require identifier id'>require</span> <span class='string val'>'time'</span>
  <span class='articles identifier id'>articles</span><span class='dot token'>.</span><span class='sort_by identifier id'>sort_by</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='a identifier id'>a</span><span class='bitor op'>|</span> <span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='parse identifier id'>parse</span><span class='lparen token'>(</span><span class='a identifier id'>a</span><span class='lbrack token'>[</span><span class='symbol val'>:created_at</span><span class='rbrack token'>]</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='reverse identifier id'>reverse</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>url_for</h3>
</div><div id="url_for-instance_method" class="section method">
  <div class="details_title">
    <div class='section methodsignature'>
    <tt class='def'>
      <span class='visibility'>public</span>
      <span class='return_types'></span>
      <span class='name'>url_for</span><span class='args'>(item)</span>
      <span class='block'></span>
    </tt>
  </div>

</div><div class="section docstring">
  <p>
Returns the URL for the given item. It will return the URL containing the
custom path in the feed if possible, otherwise the normal path.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


201
202
203</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/nanoc3/helpers/blogging.rb', line 201</span>

<span class='def def kw'>def</span> <span class='url_for identifier id'>url_for</span><span class='lparen token'>(</span><span class='item identifier id'>item</span><span class='rparen token'>)</span>
  <span class='@site ivar id'>@site</span><span class='dot token'>.</span><span class='config identifier id'>config</span><span class='lbrack token'>[</span><span class='symbol val'>:base_url</span><span class='rbrack token'>]</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='item identifier id'>item</span><span class='lbrack token'>[</span><span class='symbol val'>:custom_path_in_feed</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='item identifier id'>item</span><span class='dot token'>.</span><span class='reps identifier id'>reps</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='path identifier id'>path</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
</div>
  </div>

</div>
    </div>
    <div id="yard_info">
  Generated on Sunday, August 09 2009 at 01:43:11 PM by 
  <abbr class="yard" title="Yay! A Ruby Documentation Tool"><a href="http://yard.soen.ca">YARD</a></abbr> 
  0.2.3.2 (ruby-1.8.7).
</div>

  </body>
</html>