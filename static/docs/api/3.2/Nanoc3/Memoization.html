<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Module: Nanoc3::Memoization
  
    &mdash; Documentation by YARD 0.7.5
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '..';
  if (relpath != '') relpath += '/';
</script>

  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


    <link rel="canonical" href="http://nanoc.stoneship.org/docs/api/3.3/Nanoc/Memoization.html"/>
  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../_index.html">Index (M)</a> &raquo; 
    <span class='title'><span class='object_link'><a href="../Nanoc3.html" title="Nanoc3 (module)">Nanoc3</a></span></span>
     &raquo; 
    <span class="title">Memoization</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a id="class_list_link" href="#">Class List</a>
  
    <a id="method_list_link" href="#">Method List</a>
  
    <a id="file_list_link" href="#">File List</a>
  
</div>
      <div class="clear"></div>
      <div style="margin: 30px 0; padding: 10px; border: 2px solid red; background: #fee"><strong>WARNING:</strong> This documentation applies to nanoc 3.2, which is not the latest version. Please consult the <a href="http://nanoc.stoneship.org/docs/api/3.3/Nanoc/Memoization.html">up-to-date API documentation</a> instead.</div>

    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Module: Nanoc3::Memoization
  
  
  
</h1>

<dl class="box">
  
  
    
  
    
  
  
    <dt class="r1">Included in:</dt>
    <dd class="r1"><span class='object_link'><a href="Compiler.html" title="Nanoc3::Compiler (class)">Compiler</a></span>, <span class='object_link'><a href="Item.html" title="Nanoc3::Item (class)">Item</a></span>, <span class='object_link'><a href="Layout.html" title="Nanoc3::Layout (class)">Layout</a></span>, <span class='object_link'><a href="OutdatednessChecker.html" title="Nanoc3::OutdatednessChecker (class)">OutdatednessChecker</a></span>, <span class='object_link'><a href="RuleMemoryCalculator.html" title="Nanoc3::RuleMemoryCalculator (class)">RuleMemoryCalculator</a></span>, <span class='object_link'><a href="RulesCollection.html" title="Nanoc3::RulesCollection (class)">RulesCollection</a></span></dd>
    
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/nanoc3/base/memoization.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>Adds support for memoizing functions.</p>


  </div>
</div>
<div class="tags">
  
<h3>Since:</h3>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>3.2.0</p>
</div>
      
    </li>
  
</ul>

</div>






  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#memoize-instance_method" title="#memoize (instance method)">- (void) <strong>memoize</strong>(method_name) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Memoizes the method with the given name.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="memoize-instance_method">
  
    - (<tt>void</tt>) <strong>memoize</strong>(method_name) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p><p>Memoizes the method with the given name. The modified method will cache
the results of the original method, so that calling a method twice with
the same arguments will short-circuit and return the cached results
immediately.</p>

<p>Memoization assumes that the current object as well as the function
arguments are immutable. Mutating the object or the arguments will not
cause memoized methods to recalculate their results. There is no way to
un-memoize a result, and calculation results will remain in memory even
if they are no longer needed.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h3>Examples:</h3>
    
      <h4><div class='inline'><p>A fast fib function due to memoization</p>
</div></h4>
      <pre class="example code">
<span class='kw'>class</span> <span class='const'>FibFast</span>

  <span class='id identifier rubyid_extend'>extend</span> <span class='const'>Nanoc3</span><span class='op'>::</span><span class='const'>Memoization</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_run'>run</span><span class='lparen'>(</span><span class='id identifier rubyid_n'>n</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_n'>n</span> <span class='op'>==</span> <span class='int'>0</span>
      <span class='int'>0</span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_n'>n</span> <span class='op'>==</span> <span class='int'>1</span>
      <span class='int'>1</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_run'>run</span><span class='lparen'>(</span><span class='id identifier rubyid_n'>n</span><span class='op'>-</span><span class='int'>1</span><span class='rparen'>)</span> <span class='op'>+</span> <span class='id identifier rubyid_run'>run</span><span class='lparen'>(</span><span class='id identifier rubyid_n'>n</span><span class='op'>-</span><span class='int'>2</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_memoize'>memoize</span> <span class='symbol'>:run</span>

<span class='kw'>end</span></pre>
    
  </div>
<h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>method_name</span>
      
      
        <span class='type'>(<tt>Symbol</tt>, <tt><span class='object_link'><a href="../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The name of the method to memoize</p>
</div>
      
    </li>
  
</ul>

<h3>Since:</h3>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>3.2.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/nanoc3/base/memoization.rb', line 43</span>

<span class='kw'>def</span> <span class='id identifier rubyid_memoize'>memoize</span><span class='lparen'>(</span><span class='id identifier rubyid_method_name'>method_name</span><span class='rparen'>)</span>
  <span class='comment'># Alias
</span>  <span class='id identifier rubyid_original_method_name'>original_method_name</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>__nonmemoized_</span><span class='tstring_end'>'</span></span> <span class='op'>+</span> <span class='id identifier rubyid_method_name'>method_name</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
  <span class='id identifier rubyid_alias_method'>alias_method</span> <span class='id identifier rubyid_original_method_name'>original_method_name</span><span class='comma'>,</span> <span class='id identifier rubyid_method_name'>method_name</span>

  <span class='comment'># Redefine
</span>  <span class='id identifier rubyid_define_method'>define_method</span><span class='lparen'>(</span><span class='id identifier rubyid_method_name'>method_name</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='op'>|</span>
    <span class='comment'># Get cache
</span>    <span class='ivar'>@__memoization_cache</span> <span class='op'>||=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='ivar'>@__memoization_cache</span><span class='lbracket'>[</span><span class='id identifier rubyid_method_name'>method_name</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>

    <span class='comment'># Recalculate if necessary
</span>    <span class='kw'>if</span> <span class='op'>!</span><span class='ivar'>@__memoization_cache</span><span class='lbracket'>[</span><span class='id identifier rubyid_method_name'>method_name</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_has_key?'>has_key?</span><span class='lparen'>(</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='id identifier rubyid_original_method_name'>original_method_name</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
      <span class='ivar'>@__memoization_cache</span><span class='lbracket'>[</span><span class='id identifier rubyid_method_name'>method_name</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_args'>args</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_result'>result</span>
    <span class='kw'>end</span>

    <span class='comment'># Done
</span>    <span class='ivar'>@__memoization_cache</span><span class='lbracket'>[</span><span class='id identifier rubyid_method_name'>method_name</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_args'>args</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-15639968-1");
pageTracker._trackPageview();
} catch(err) {}</script>

  </body>
</html>
