<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Module: Nanoc3::Helpers::Capturing
  
    &mdash; Documentation by YARD 0.7.5
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '../..';
  if (relpath != '') relpath += '/';
</script>

  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


    <link rel="canonical" href="http://nanoc.stoneship.org/docs/api/3.3/Nanoc/Helpers/Capturing.html"/>
  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../../_index.html">Index (C)</a> &raquo; 
    <span class='title'><span class='object_link'><a href="../../Nanoc3.html" title="Nanoc3 (module)">Nanoc3</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Helpers.html" title="Nanoc3::Helpers (module)">Helpers</a></span></span>
     &raquo; 
    <span class="title">Capturing</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a id="class_list_link" href="#">Class List</a>
  
    <a id="method_list_link" href="#">Method List</a>
  
    <a id="file_list_link" href="#">File List</a>
  
</div>
      <div class="clear"></div>
      <div style="margin: 30px 0; padding: 10px; border: 2px solid red; background: #fee"><strong>WARNING:</strong> This documentation applies to nanoc 3.2, which is not the latest version. Please consult the <a href="http://nanoc.stoneship.org/docs/api/3.3/Nanoc/Helpers/Capturing.html">up-to-date API documentation</a> instead.</div>

    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Module: Nanoc3::Helpers::Capturing
  
  
  
</h1>

<dl class="box">
  
  
    
  
    
  
  
    <dt class="r1">Included in:</dt>
    <dd class="r1"><span class='object_link'><a href="Filtering.html" title="Nanoc3::Helpers::Filtering (module)">Filtering</a></span>, <span class='object_link'><a href="HTMLEscape.html" title="Nanoc3::Helpers::HTMLEscape (module)">HTMLEscape</a></span>, <span class='object_link'><a href="Rendering.html" title="Nanoc3::Helpers::Rendering (module)">Rendering</a></span></dd>
    
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/nanoc3/helpers/capturing.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>Provides functionality for “capturing” content in one place and reusing
this content elsewhere.</p>

<p>For example, suppose you want the sidebar of your site to contain a short
summary of the item. You could put the summary in the meta file, but
that’s not possible when the summary contains eRuby. You could also put
the sidebar inside the actual item, but that’s not very pretty. Instead,
you write the summary on the item itself, but capture it, and print it in
the sidebar layout.</p>

<p>This helper has been tested with ERB and Haml. Other filters may not work
correctly.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h3>Examples:</h3>
    
      <h4><div class='inline'><p>Capturing content for a summary</p>
</div></h4>
      <pre class="example code">
&lt;% content_for :summary do %&gt;
  &lt;p&gt;On this item, nanoc is introduced, blah blah.&lt;/p&gt;
&lt;% end %&gt;</pre>
    
      <h4><div class='inline'><p>Showing captured content in a sidebar</p>
</div></h4>
      <pre class="example code">
&lt;div id=&quot;sidebar&quot;&gt;
  &lt;h3&gt;Summary&lt;/h3&gt;
  &lt;%= content_for(@item, :summary) || '(no summary)' %&gt;
&lt;/div&gt;</pre>
    
      <h4><div class='inline'><p>Showing captured content in a sidebar the old, deprecated way (do not use or I will become very angry)</p>
</div></h4>
      <pre class="example code">
&lt;div id=&quot;sidebar&quot;&gt;
  &lt;h3&gt;Summary&lt;/h3&gt;
  &lt;%= @item[:content_for_summary] || '(no summary)' %&gt;
&lt;/div&gt;</pre>
    
  </div>


</div><h2>Defined Under Namespace</h2>
<p class="children">
   
    
   
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="Capturing/CapturesStore.html" title="Nanoc3::Helpers::Capturing::CapturesStore (class)">CapturesStore</a></span>
    
  
</p>







  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#capture-instance_method" title="#capture (instance method)">- (String) <strong>capture</strong>(&amp;block) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Evaluates the given block and returns its contents.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#content_for-instance_method" title="#content_for (instance method)">- (Object) <strong>content_for</strong>(*args, &amp;block) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
    </ul>
  



  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="capture-instance_method">
  
    - (<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>) <strong>capture</strong>(&amp;block) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>Evaluates the given block and returns its contents. The contents of the
block is not outputted.</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The captured result</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/nanoc3/helpers/capturing.rb', line 118</span>

<span class='kw'>def</span> <span class='id identifier rubyid_capture'>capture</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='comment'># Get erbout so far
</span>  <span class='id identifier rubyid_erbout'>erbout</span> <span class='op'>=</span> <span class='id identifier rubyid_eval'>eval</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>_erbout</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='id identifier rubyid_binding'>binding</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_erbout_length'>erbout_length</span> <span class='op'>=</span> <span class='id identifier rubyid_erbout'>erbout</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span>

  <span class='comment'># Execute block
</span>  <span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span>

  <span class='comment'># Get new piece of erbout
</span>  <span class='id identifier rubyid_erbout_addition'>erbout_addition</span> <span class='op'>=</span> <span class='id identifier rubyid_erbout'>erbout</span><span class='lbracket'>[</span><span class='id identifier rubyid_erbout_length'>erbout_length</span><span class='op'>..</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span>

  <span class='comment'># Remove addition
</span>  <span class='id identifier rubyid_erbout'>erbout</span><span class='lbracket'>[</span><span class='id identifier rubyid_erbout_length'>erbout_length</span><span class='op'>..</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_end'>'</span></span>

  <span class='comment'># Done
</span>  <span class='id identifier rubyid_erbout_addition'>erbout_addition</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="content_for-instance_method">
  
    
      <span class="overload">- (<tt>void</tt>) <strong>content_for</strong>(name, &amp;block) </span>
    
      <span class="overload">- (<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>) <strong>content_for</strong>(item, name) </span>
    
  

  
</p><div class="docstring">
  <div class="discussion">
    


  </div>
</div>
<div class="tags">
  
  <h3>Overloads:</h3>
  <ul class="overload">
    
      
      <li class="overload_item">
        <span class="signature">- (<tt>void</tt>) <strong>content_for</strong>(name, &amp;block) </span>
        <div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p><p>Captures the content inside the block and stores it so that it can be
referenced later on. The same method, <span class='object_link'><a href="#content_for-instance_method" title="Nanoc3::Helpers::Capturing#content_for (method)">#content_for</a></span>, is used for
getting the captured content as well as setting it. When capturing,
the content of the block itself will not be outputted.</p>

<p>For backwards compatibility, it is also possible to fetch the captured
content by getting the contents of the attribute named <code>content_for_</code>
followed by the given name. This way of accessing captures is
deprecated.</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>name</span>
      
      
        <span class='type'>(<tt>Symbol</tt>, <tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The base name of the attribute into which
the content should be stored</p>
</div>
      
    </li>
  
</ul>


</div>
      </li>
    
      
      <li class="overload_item">
        <span class="signature">- (<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>) <strong>content_for</strong>(item, name) </span>
        <div class="docstring">
  <div class="discussion">
    <p>Fetches the capture with the given name from the given item and
returns it.</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>item</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Item.html" title="Nanoc3::Item (class)">Nanoc3::Item</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The item for which to get the capture</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>name</span>
      
      
        <span class='type'>(<tt>Symbol</tt>, <tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The name of the capture to fetch</p>
</div>
      
    </li>
  
</ul>

<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The stored captured content</p>
</div>
      
    </li>
  
</ul>

</div>
      </li>
    
  </ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/nanoc3/helpers/capturing.rb', line 88</span>

<span class='kw'>def</span> <span class='id identifier rubyid_content_for'>content_for</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span> <span class='comment'># Set content
</span>    <span class='comment'># Get args
</span>    <span class='kw'>if</span> <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>!=</span> <span class='int'>1</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>expected 1 argument (the name </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> 
        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>of the capture) but got </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='rbrace'>}</span><span class='tstring_content'> instead</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>

    <span class='comment'># Capture and store
</span>    <span class='id identifier rubyid_content'>content</span> <span class='op'>=</span> <span class='id identifier rubyid_capture'>capture</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
    <span class='const'>CapturesStore</span><span class='period'>.</span><span class='id identifier rubyid_instance'>instance</span><span class='lbracket'>[</span><span class='ivar'>@item</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_to_sym'>to_sym</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_content'>content</span>
  <span class='kw'>else</span> <span class='comment'># Get content
</span>    <span class='comment'># Get args
</span>    <span class='kw'>if</span> <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>!=</span> <span class='int'>2</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>expected 2 arguments (the item </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span>
        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>and the name of the capture) but got </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='rbrace'>}</span><span class='tstring_content'> instead</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_item'>item</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span>

    <span class='comment'># Get content
</span>    <span class='const'>CapturesStore</span><span class='period'>.</span><span class='id identifier rubyid_instance'>instance</span><span class='lbracket'>[</span><span class='id identifier rubyid_item'>item</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_to_sym'>to_sym</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-15639968-1");
pageTracker._trackPageview();
} catch(err) {}</script>

  </body>
</html>
